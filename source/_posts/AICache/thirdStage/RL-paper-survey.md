---
title: RL paper survey
date: 2025-07-04 10:03:02
categories:
- [paper]
- [data storage]
tags:
- algorithm
- RL
- 实习项目
---



# 1. ArtMem

ArtMem：Adaptive Migration in Reinforcement Learning-Enabled Tiered Memory

## 背景：

内存系统只靠 DRAM 不足，因此引入 PM 和基于 CXL 的额外内存，形成快慢速的分层内存系统。

但现有分层内存系统中的页面迁移策略不够 adaptive，没有充分考虑到工作负载的动态性，因此引入强化学习策略。

### 内存访问监控

内存访问监控方面一般有三种方式：页表扫描、页错误捕捉、硬件事件采样。

页表扫描通过检查页面表访问位获取访问信息，但扫描开销高，尤其在页面数量庞大时；

页错误捕捉仅监控未命中的页面，信息不完整；

硬件事件采样利用CPU的性能监控单元（PMU）和精确事件采样（PEBS），以低开销捕获全面的访问数据。但是存在硬件依赖。

ArtMem选择第三种方式，通过每个CPU核心的采样线程收集页面访问地址和频率，存储在环形缓冲区，结合指数桶（以2为底）和冷却操作（每200万样本减半计数），高效跟踪访问分布。

### 页迁移指标

页面迁移需要决策是迁移掉访问频率低的，还是迁移掉最近未访问过的？

ArtMem综合考虑访问频率和最近性，以更准确地识别热页面。

最近性通过Linux的活跃页面列表（active list）和非活跃页面列表（inactive list）获取，基于LRU（最近最少使用）机制。

访问频率通过指数移动平均（EMA）计算，平滑短期波动，反映页面的长期访问趋势。

EMA 值反映了频率和最近性的结合。EMA 公式一般来说如下所示。
$$
EMA_t = α·Access_t + (1-α)·EMA_{t-1}
$$
其中，`Access_t`是当前时间步的访问频率，`α`是平滑因子，`EMA_t`是前一时间步的EMA值。

### DRAM 快速访问比例

DRAM 访问比例可以实时反映内存利用率。利用该信息，可以做出一些更加针对性的页放置决策。

因此将此指标设计为强化学习的状态参数。

### 页迁移范围

页迁移范围也是一个比较重要的指标，因此也将其和热页面阈值一起，作为 RL 调节的环境对象属性。

## ArtMem 设计

### 强化学习建模

| RL framework | ArtMem Framwork                    |
| ------------ | ---------------------------------- |
| 状态         | discretized DRAM access ratio      |
| 动作         | 调节热页面阈值 \| 调节页面迁移数量 |
| 奖励         | 见下文                             |

#### 动作

1. 调节热页面阈值方面：±8，±4，0
2. 调节页迁移数量范围：16MB - 2048MB（以 2MB 的内存大页为单位）

#### 奖励

$$
τ_i-β+λ(τ_i-τ_{i-1})
$$

上述公式中，`τ`表示实际 DRAM 访问比例，`β` 预期达到的 DRAM 访问比例。`λ` 代表上一个时间阶段是否发生了页面迁移，为 0 表示没有发生页面迁移，故 DRAM 访问比例差不作考虑因素。



### 架构图分析

Artem 架构图如下：

<img src="\img\ArtMem architecute.png" alt="ArtMem architecute" style="zoom: 67%;" />

PMU（Performance Monitoring Unit）监控内存访问情况。



ArtMem 总览图：

<img src="\img\overview of ArtMem.png" alt="overview of ArtMem" style="zoom:67%;" />

图中左上角是内存访问次数分布图，记录了每个页面的访问次数。由页面阈值和迁移范围两个参数共同决定了最后的实际迁移范围。

右侧的 DRAM 层和 PM 层都维护了一个基于 LRU 排序的活跃和不活跃的页面队列。也就是架构图中提到的 Page sorting 操作。

异步的迁移线程收到迁移指令之后，从 DRAM 的不活跃列表中从尾部向前进行降级，当 DRAM 空间足够之后，再从 PM 活跃队列头开始依次往上升级。



Q：在实际迁移过程中，是否需要判断当前正在迁移的页面的访问次数是否小于热页面阈值呢？

A：论文中没提，大概率不需要，因此这里的热页面阈值可能只是辅助调整迁移数量参数。



## 扩展思考

### 创新点

1. 强化学习驱动，具有动态自适应性。
2. 系统级粒度，不对某个具体页面做决策。通过监控系统中 DRAM 的访问比例来调节热页面阈值和迁移数量的参数。
3. 存储空间压缩率高。指数桶存储页面访问分布，利用 Linux 大页的 struct page 中未使用字段存储页面访问信息。
4. 用户空间 RL 通过伪文件系统与操作系统交互。
5. 异步处理。采样线程和页面迁移线程都在后天异步执行，不影响主 IO 性能。





## 关联文章

1. CHROME: Concurrency-Aware Holistic Cache Management Framework with Online Reinforcement Learning

利用强化学习对缓存行为做决策。



## 待更新内容

1. 结合 IO 路径再捋一下 RL 具体如何发挥作用

